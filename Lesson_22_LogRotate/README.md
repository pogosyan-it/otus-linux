# RSYSLOG

 Для запуска стенда необиходимо скачать в локальную папку файлы из репозитория и запустиить: `vagrant up` <br/>
 В файле `script.sh` происходит установка утилиты rsyslog, chrony, auditd и audispd-plugins на обе ВМ, отключение selinux.  <br/>
 Для `web` устанавливается nginx и копируются конфиги в соответствующие директории. Так как используется версия nginx 1.17, то поддержка отправки должна работать на    
 уровне конфига nginx.conf - для error и access необходимо добавить следующие строки:<br/>
 error_log syslog:server=192.168.11.171:514,facility=local7,tag=nginx,severity=error;<br/>
 access_log syslog:server=192.168.11.171:514,tag=nginx,nohostname,severity=info combined; <br/>
 Так как nginx разделяет потоки error_log и access_log, что означает, что нам надо их объединить но снабдить тегами, чтобы впоследствии легко можно было бы различить.
 Для получения системных логов, достаточно разрешить транспортные протоколы TCP и UDP  еще добавить:<br/>
 $template RemoteLogs,"/var/log/%fromhost-ip%/%PROGRAMNAME%.log" <br/>
 *.* ?RemoteLogs <br/>
 & ~ <br/>
 Чтобы убедлится что помимо логов изменения в конфигурации, пишутся и access логи, достаточно выполнить:
 curl http://192.168.11.170/ <br/>
 Сразу получим лог: <br/>

Sep 28 23:33:27 192.168.11.170 nginx: 192.168.11.1 - - [28/Sep/2020:23:33:27 +0300] "GET / HTTP/1.1" 200 4833 "-" "curl/7.58.0"<br/>

Чтобы писать не все логи с хоста на сервер, а только критичные и выше необходимо в файле `/etc/rsyslog.conf` на стороне клиента добавить следующуюс строку:
`*.crit @@192.168.11.171:514`. Чтобы увидить результат на сервере, так как критические проблемы вызвать на клиенте не так легко, можно вписать вместо crit --> notice.
После чего сразу появится в папке /var/log/ директория с ip web-сервера. 

# AUDITD




